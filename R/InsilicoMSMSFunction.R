#' @title MetFragMatch
#' @author Zhiwei Zhou
#' @param  DatabaseSearchRelativeMassDeviation Default: 5ppm
#' @param FragmentPeakMatchAbsoluteMassDeviation Default: 0.001Da
#' @param FragmentPeakMatchRelativeMassDeviation Default: 5.0ppm
#' @param MetFragDatabaseType 'PubChem'
#' @param NeutralPrecursorMass 253.966126
#' @param PeakList matrix with 2 columns, 1st: mz, 2nd: intensity
#' @return a data.frame with scores and candidate properties
#' @export
#' @example
#' test_spec <- matrix(c(
#' 90.97445, 681,
#' 106.94476, 274,
#' 110.02750, 110,
#' 115.98965, 95,
#' 117.98540, 384,
#' 124.93547, 613,
#' 124.99015, 146,
#' 125.99793, 207,
#' 133.95592, 777,
#' 143.98846, 478,
#' 144.99625, 352,
#' 146.00410, 999,
#' 151.94641, 962,
#' 160.96668, 387,
#' 163.00682, 782,
#' 172.99055, 17,
#' 178.95724, 678,
#' 178.97725, 391,
#' 180.97293, 999,
#' 196.96778, 720,
#' 208.96780, 999,
#' 236.96245, 999,
#' 254.97312, 999), ncol=2, byrow=TRUE)
#' MetFragMatch(DatabaseSearchRelativeMassDeviation = 5,
#'              FragmentPeakMatchAbsoluteMassDeviation = 0.001,
#'              FragmentPeakMatchRelativeMassDeviation = 5,
#'              MetFragDatabaseType = 'PubChem',
#'              NeutralPrecursorMass = 253.966126,
#'              PeakList = test_spec)


setGeneric(name = 'MetFragMatch',
           def = function(
             DatabaseSearchRelativeMassDeviation = 5, # ppm
             FragmentPeakMatchAbsoluteMassDeviation = 0.001, # Da
             FragmentPeakMatchRelativeMassDeviation = 5.0, # ppm
             MetFragDatabaseType = 'PubChem',
             NeutralPrecursorMass = 253.966126,
             PeakList
           ){

             # creat parameter set
             settingsObject<-list()
             settingsObject[["DatabaseSearchRelativeMassDeviation"]] <- DatabaseSearchRelativeMassDeviation
             settingsObject[["FragmentPeakMatchAbsoluteMassDeviation"]] <- FragmentPeakMatchAbsoluteMassDeviation
             settingsObject[["FragmentPeakMatchRelativeMassDeviation"]] <- FragmentPeakMatchRelativeMassDeviation
             settingsObject[["MetFragDatabaseType"]] <- MetFragDatabaseType

             settingsObject[["NeutralPrecursorMass"]] <- NeutralPrecursorMass

             settingsObject[["PeakList"]]<- PeakList

             # run MetFrag
             scored.candidates <- metfRag::run.metfrag(settingsObject)

           }
)
